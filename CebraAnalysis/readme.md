# Neural Data Analysis Using CEBRA Model

## Overview

This repository provides a framework to train and test a model using neural data and kinematic data derived from a MATLAB file. The core functionality is encapsulated in the `model` class, which leverages the CEBRA model for data embedding and regression analysis.

## `model` Class

### Methods

#### `train(neural_session, continous_sessions)`

- **Purpose**: 
  Trains the CEBRA model using neural data (`neural_session`) and corresponding kinematic data (`continous_sessions`). The method fits the model and trains decoders using kinematic data, conditioned on position data.
  
- **Parameters**: 
  - `neural_session`: A list of arrays where each array contains neural activity data.
  - `continous_sessions`: A list of arrays where each array contains kinematic data associated with the neural activity.
  
- **Returns**: 
  - None. The trained model and decoders are stored within the class instance.

#### `predict(neural_session)`

- **Purpose**: 
  Generates predictions for kinematic data based on new neural data.
  
- **Parameters**: 
  - `neural_session`: A list of arrays where each array contains new neural activity data for prediction.
  
- **Returns**: 
  - `out`: A list of predicted kinematic data corresponding to the input neural sessions.

#### `get_embedding(neural_session)`

- **Purpose**: 
  Extracts the embedded representations from the neural data using the trained CEBRA model.
  
- **Parameters**: 
  - `neural_session`: A list of arrays where each array contains neural activity data.
  
- **Returns**: 
  - `out`: A list of embeddings generated by the CEBRA model.

#### `examine(neural_session, continous_sessions)`

- **Purpose**: 
  Evaluates the model's performance by calculating the R^2 score of the predicted kinematic data against the actual kinematic data.
  
- **Parameters**: 
  - `neural_session`: A list of arrays where each array contains neural activity data.
  - `continous_sessions`: A list of arrays where each array contains the actual kinematic data corresponding to the neural activity.
  
- **Returns**: 
  - `r2`: A list of R^2 scores for each session.

## `main` Function

### Purpose

The `main` function serves as the entry point for running the neural data analysis. It loads the data, splits it into training and testing sets, trains the model, and then evaluates it.

### How to Append to the `main` Function

To customize the analysis or add additional steps, you can modify the `main` function as follows:

1. **Load Additional Data**: You can load more datasets using the `loadMatlab` function and process them as needed.

2. **Modify the Train/Test Split**: Adjust the `train_test_split` parameters to control the size of your training and testing datasets.

3. **Additional Analysis**: Insert custom analysis or post-processing steps after training or prediction. For example, you could visualize the embeddings, or save the results to a file.

### Example of Adding Custom Analysis

You might want to add a step to visualize the embeddings:

```python
# Visualize embeddings after training
embeddings = stim_0.get_embedding(X_train)
plt.scatter(embeddings[:, 0], embeddings[:, 1])
plt.title('Neural Data Embeddings')
plt.show()
```

## Contributing

### Making Additions
To make additions or changes to the code, follow these steps:

1. **Create a New Branch**: Always create a new branch before making changes.
```
git checkout -b feature/your-feature-name
```
2. **Make Your Changes**: Implement your new features or modifications in the branch.
3. **Push to Remote**: Push your branch to the remote repository.
```
git push origin feature/your-feature-name
```

## Branch Naming Convention
* Use descriptive names for your branches, prefixed with feature/, fix/, or chore/ depending on the nature of the change.
    * Example: feature/improve-model-performance

## License
This project is licensed under the MIT License. See the LICENSE file for more details.

```
This README provides a clear guide for users to understand and work with the `model` class, extend the `main` function, and contribute to the repository.
```